//DESCRIPTION:Convert Faux Blacks#target indesign var prefsLocation = File((Folder(app.activeScript)).parent);if (parseFloat(app.version) < 6)doReplace();elseapp.doScript(doReplace, ScriptLanguage.JAVASCRIPT, undefined, UndoModes.ENTIRE_SCRIPT, "Convert Faux Blacks");function doReplace (){if(app.documents.length !=0)	{	var myDoc = app.activeDocument;//the indesign file that is currently open  	}else	{	alert("Please open a document and try again.");  //no file is open and this warning is presented	exit(0);	}var myDoc = app.activeDocument;var mySwatch = myDoc.swatches;app.menuActions.item("$ID/Add All Unnamed Colors").invoke();var myDialog = app.dialogs.add({name:"Faux Black Converter"});  //, canCancel:falsewith(myDialog)  {    with(dialogColumns.add())    {         with(dialogRows.add())         {                  staticTexts.add({staticLabel:"Faux Blacks start at:"});            with(dialogRows.add())             {                staticTexts.add({staticLabel:"C"});                var fbc = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:75});//integerEditboxes.add({minwidth:100, editValue:1});                staticTexts.add({staticLabel:"M"});                var fbm = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:67});//integerEditboxes.add({minwidth:100, editValue:1});                staticTexts.add({staticLabel:"Y"});                var fby = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:68});//integerEditboxes.add({minwidth:100, editValue:1});                staticTexts.add({staticLabel:"K"});                var fbk = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:90});//integerEditboxes.add({minwidth:100, editValue:1});            }         }         with(dialogRows.add())         {                  staticTexts.add({staticLabel:"Change Blacks to:"});            with(dialogRows.add())             {                staticTexts.add({staticLabel:"C"});                var mbc = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:0});//integerEditboxes.add({minwidth:100, editValue:1});                staticTexts.add({staticLabel:"M"});                var mbm = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:0});//integerEditboxes.add({minwidth:100, editValue:1});                staticTexts.add({staticLabel:"Y"});                var mby = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:0});//integerEditboxes.add({minwidth:100, editValue:1});                staticTexts.add({staticLabel:"K"});                var mbk = integerEditboxes.add ({minimumValue : 0, maximumValue : 100, smallNudge: 1, largeNudge: 5, editValue:100});//integerEditboxes.add({minwidth:100, editValue:1});            }      }     }  }  //Show the dialog box.var myResult = myDialog.show();if(myResult == false){alert("Make a mistake, did we? No worries.");  exit(0);  }else{for (var j=4; j<mySwatch.length; j++)	{        var fauxc=fbc.editContents * 1;        var fauxm=fbm.editContents * 1;        var fauxy=fby.editContents * 1;        var fauxk=fbk.editContents * 1;        var truec=mbc.editContents * 1;        var truem=mbm.editContents * 1;        var truey=mby.editContents * 1;        var truek=mbk.editContents * 1;    try {   //colorValue[0] in the line below is the Cyan value (70 at the moment), colorValue[1] is the Magenta value, and so on.        if(mySwatch[j].space == ColorSpace.CMYK && mySwatch[j].colorValue[0] >=  fauxc && mySwatch[j].colorValue[1] >=  fauxm && mySwatch[j].colorValue[2] >=  fauxy && mySwatch[j].colorValue[3] >=  fauxk && mySwatch[j].model===ColorModel.PROCESS){	            mySwatch[j].model=ColorModel.PROCESS;            mySwatch[j].space = ColorSpace.CMYK;           mySwatch[j].colorValue = [truec,truem,truey,truek];//My definition of a rich black. Change it to whatever suits you, values are C,M,Y,K.            try {                 mySwatch[j].name = "C="+truec + " M="+truem + " Y="+truey + " K="+truek;                }catch(e){                mySwatch[j].remove(mySwatch[j].name);                }            }        }catch(e){}//{alert(e)}          }    }}