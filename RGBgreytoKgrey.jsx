//DESCRIPTION:Convert RGB greys to shades of black#target indesign if (parseFloat(app.version) < 6)doReplace();elseapp.doScript(doReplace, ScriptLanguage.JAVASCRIPT, undefined, UndoModes.ENTIRE_SCRIPT, "Convert RGB greys to shades of black");function doReplace (){if(app.documents.length !=0)	{	var myDoc = app.activeDocument;//the indesign file that is currently open  	}else	{	alert("Please open a document and try again.");  //no file is open and this warning is presented	exit(0);	}var myDoc = app.activeDocument;var mySwatch = myDoc.swatches;for (var j=4; j<mySwatch.length; j++)	{    try {           if(mySwatch[j].space == ColorSpace.RGB && mySwatch[j].colorValue[0] ==  mySwatch[j].colorValue[1] &&  mySwatch[j].colorValue[1] ==  mySwatch[j].colorValue[2] && mySwatch[j].model===ColorModel.PROCESS){	            var r = mySwatch[j].colorValue[0];            var x = (r/255);            var calcValue = (1 - x) * 100;            mySwatch[j].model=ColorModel.PROCESS;            mySwatch[j].space = ColorSpace.CMYK;           mySwatch[j].colorValue = [0,0,0,calcValue];            var myCV = mySwatch[j].colorValue;            try {                 mySwatch[j].name = "C=0" + " M=0" + " Y=0" + " K=" + Math.round(myCV[3]);                }catch(e){                mySwatch[j].remove(mySwatch[j].name);                }            }        }catch(e){}//{alert(e)}          }var myColors = myDoc.colors;var myBlack = myDoc.swatches.itemByName("Black");var myWhite = myDoc.swatches.itemByName("Paper"); for (i = myColors.length-1; i >= 0; i--) {    var myColor = myColors[i];    if (myColor.colorValue == "0,0,0,100" && myColor.name != "Black" && myColor.model===ColorModel.PROCESS) {        myColor.remove(myBlack);        }}for (i = myColors.length-1; i >= 0; i--) {    var myColor = myColors[i];    if (myColor.colorValue == "0,0,0,0" && myColor.name != "Paper") {        myColor.remove(myWhite);        }}}